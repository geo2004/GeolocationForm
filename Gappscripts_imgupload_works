let app = SpreadsheetApp.openByUrl("https://docs.google.com/spreadsheets/d/1TcqmY_ugD0d6SfqkiQMkfx-ONUHCmV4Bh-_axIk0RAc/edit#gid=0");
let sheet = app.getSheetByName("Gsheet");

function doPost(e){
  try{
    let obj = JSON.parse(e.postData.contents);
    let dcode = Utilities.base64Decode(obj.base64);
    let blob = Utilities.newBlob(dcode,obj.type,obj.name);
    let folder = DriveApp.getFoldersByName("Uploads").next();
    let newFile = folder.createFile(blob);
    let link = newFile.getUrl();
    let lr = sheet.getLastRow();
sheet.getRange(lr+1, 7, 1, 2).setValues([[obj.name, link]]);
    return ContentService.createTextOutput("image uploaded")
  }catch(err){
    return ContentService.createTextOutput(err)
  }
}
